<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lambda Layer Pip Command Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light p-5">
  <div class="container">
    <h1 class="mb-4">AWS Lambda Layer Pip Command Generator</h1>

    <div class="mb-3">
      <label for="pythonVersion" class="form-label">Select Python Version</label>
      <select id="pythonVersion" class="form-select">
        <option value="3.9">3.9</option>
        <option value="3.10">3.10</option>
        <option value="3.11">3.11</option>
        <option value="3.12">3.12</option>
        <option value="3.13">3.13</option>
      </select>
    </div>

    <div class="mb-3">
      <label for="packages" class="form-label">Enter Package Names (comma-separated)</label>
      <input type="text" class="form-control" id="packages" placeholder="e.g., openpyxl, pandas" />
    </div>

    <div class="mb-3">
      <label for="target" class="form-label">Target Folder</label>
      <div class="mb-2">
        <button type="button" class="btn btn-secondary btn-sm me-2" onclick="setDefaultTarget(1)">Default Layer Target</button>
        <button type="button" class="btn btn-secondary btn-sm" onclick="setDefaultTarget(2)">Simple Target (python/)</button>
      </div>
      <input type="text" class="form-control" id="target" placeholder="e.g., lambda-layer/python/lib/python3.10/site-packages" />
    </div>

    <div class="form-check mb-3">
      <input class="form-check-input" type="checkbox" id="splitCommands">
      <label class="form-check-label" for="splitCommands">Generate pip command for each package</label>
    </div>

    <button class="btn btn-success" onclick="generateCommand()">Generate pip install Command</button>

    <pre id="output" class="mt-4 p-3 bg-white border rounded"></pre>
  </div>

  <script>
    function setDefaultTarget(option) {
      const version = document.getElementById("pythonVersion").value;
      const targetInput = document.getElementById("target");

      if (option === 1) {
        targetInput.value = `lambda-layer/python/lib/python${version}/site-packages`;
      } else if (option === 2) {
        targetInput.value = "python/";
      }
    }

    function generateCommand() {
      const version = document.getElementById("pythonVersion").value;
      const packageList = document.getElementById("packages").value
        .split(',')
        .map(pkg => pkg.trim())
        .filter(pkg => pkg.length > 0);
      const target = document.getElementById("target").value;
      const split = document.getElementById("splitCommands").checked;

      if (packageList.length === 0 || !target) {
        document.getElementById("output").textContent = "Please enter both package names and a target folder.";
        return;
      }

      let output = "";

      if (split) {
        output = packageList.map(pkg => {
          return `pip install ${pkg} --platform manylinux2014_x86_64 --target=${target} --python-version ${version} --only-binary=:all:`;
        }).join("\n\n");
      } else {
        output = `pip install ${packageList.join(' ')} --platform manylinux2014_x86_64 --target=${target} --python-version ${version} --only-binary=:all:`;
      }

      document.getElementById("output").textContent = output;
    }
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
